"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7840],{27840:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(69060),o=s(98372),r=s(51560),i=s(85172),l=s(3084),n=s(34896),d=s(92332),c=s(63528),u=s(82496);const p=s(93424);let m=null;const h=()=>{const e=(0,r.i6)(),[t,s]=(0,a.useState)(!1),[h,x]=(0,a.useState)([]),[j,y]=(0,a.useState)(""),[g,b]=(0,a.useState)(null),[f,k]=(0,a.useState)(1),[S,w]=(0,a.useState)(null),[A,v]=(0,a.useState)("NIFTY"),[I,N]=(0,a.useState)(0),[O,_]=(0,a.useState)(0),[z,C]=(0,a.useState)(null),[V,W]=(0,a.useState)(!1),[F,Q]=(0,a.useState)({name:"",email:""}),[X,J]=(0,a.useState)(""),[B,M]=(0,a.useState)(!1),[Y,L]=(0,a.useState)([]),[P,R]=(0,a.useState)([]),[T,D]=(0,a.useState)(""),E=localStorage.getItem("placeOrderData");console.log(E),console.log("kkr");const U=E.split(",");console.log(U[2]);const G=async(e,t)=>{console.log("llr"),console.log(t);try{const a=await(async e=>{let t={"Content-type":"application/json",Authorization:"Bearer "+e};const s=await fetch("https://api-v2.upstox.com/feed/market-data-feed/authorize",{method:"GET",headers:t});if(!s.ok)throw new Error("Network response was not ok");return(await s.json()).data.authorizedRedirectUri})(e),o=new WebSocket(a);return o.onopen=()=>{s(!0),console.log("Connected");const e={guid:"someguid",method:"sub",data:{mode:"full",instrumentKeys:[t]}};o.send(c.Sn.from(JSON.stringify(e)))},o.onclose=()=>{s(!1),console.log("Disconnected")},o.onmessage=async e=>{var s,a,o;const r=await(async e=>"arrayBuffer"in e?await e.arrayBuffer():new Promise(((t,s)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=()=>s(),a.readAsArrayBuffer(e)})))(e.data);let l=(e=>m?m.lookupType("com.upstox.marketdatafeeder.rpc.proto.FeedResponse").decode(e):(console.warn("Protobuf part not initialized yet!"),null))(c.Sn.from(r));x((e=>[...e,JSON.stringify(l)])),b(null===(s=l.feeds[t].ff.marketFF)||void 0===s?void 0:s.ltpc),C(null===(a=l.feeds[t].ff.marketFF)||void 0===a?void 0:a.marketLevel.bidAskQuote);const[n,d]=(0,i.U9)(null===(o=l.feeds[t].ff.marketFF)||void 0===o?void 0:o.marketLevel.bidAskQuote);N(n),_(d),console.log(l)},o.onerror=e=>{s(!1),console.log("WebSocket error:",e)},()=>o.close()}catch(a){console.error("WebSocket connection error:",a)}};(0,a.useEffect)((()=>((async()=>{m=await p.load(d),console.log("Protobuf part initialization complete")})(),y(U[3]),G(i.a,U[0]),()=>{})),[A,i.a]);const Z=async()=>{const t=localStorage.getItem("userData");let s=JSON.parse(t);s=JSON.parse(s),console.log(s);let a=s.data.token;console.log(a);const r={user_id:s.data.user_id,symbol:U[0],trading_symbol:U[2],exchange:U[11],trade_type:U[9],equity_short:V,expiry_date:U[5],quantity:f,lot_size:U[8]};try{const t={"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(a)};console.log(t),console.log(r);const s=await o.c.post("http://139.59.39.167/api/v1/order",r,{headers:t});J(s.data);const i=s.data.data.message;alert(i),console.log(s.data),"Insuficeint balance!"!=i&&e("/portfolio")}catch(i){console.error("Error submitting data:",i),J("An error occurred while submitting data.")}};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.AX,{children:[(0,u.jsx)(l.oV,{sm:3}),(0,u.jsx)(l.oV,{sm:6,children:(0,u.jsx)(l.Uj,{className:"mb-4",color:"primary",value:(0,u.jsx)(u.Fragment,{children:null===g||void 0===g?void 0:g.ltp}),title:""!==j?j:U[2],chart:(0,u.jsx)(n.Gu,{className:"mt-3 mx-3",style:{height:"70px"},data:{labels:["","","","","","",""],datasets:[{label:"",backgroundColor:"transparent",borderColor:"rgba(255,255,255,.55)",pointBackgroundColor:"#321fdb",data:[65,59,84,84,51,55,40]}]},options:{plugins:{legend:{display:!1}},maintainAspectRatio:!1,scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{display:!1}},y:{min:30,max:89,display:!1,grid:{display:!1},ticks:{display:!1}}},elements:{line:{borderWidth:1,tension:.4},point:{radius:4,hitRadius:10,hoverRadius:4}}}})})})]}),(0,u.jsxs)(l.AX,{children:[(0,u.jsx)(l.oV,{sm:3}),(0,u.jsxs)(l.oV,{sm:6,children:[(0,u.jsx)(l.AX,{children:(0,u.jsx)(l.oV,{sm:12,children:(0,u.jsx)(l.mL,{activeItemKey:2,children:(0,u.jsxs)(l.qu,{itemKey:1,children:[(0,u.jsx)(l.M1,{children:"Details"}),(0,u.jsx)(l.g$,{children:(0,u.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid black",textAlign:"center"},children:[(0,u.jsxs)("tr",{style:{margin:"0",padding:"0"},children:[(0,u.jsx)("th",{style:{border:"1px solid black"},children:"Bid"}),(0,u.jsx)("th",{style:{border:"1px solid black"},children:"Ask"})]}),null===z||void 0===z?void 0:z.map(((e,t)=>(0,u.jsx)(a.Fragment,{children:(0,u.jsxs)("tr",{style:{fontWeight:"bold"},children:[(0,u.jsxs)("td",{style:{border:"1px solid black",fontSize:"10px"},children:["Quantity:",e.bq," | Price:",e.bp," "]}),(0,u.jsxs)("td",{style:{border:"1px solid black",fontSize:"10px"},children:["Quantity:",e.aq," | Price:",e.ap," "]})]})},t)))]})})]})})})}),(0,u.jsx)(l.AX,{children:(0,u.jsxs)(l.oV,{sm:12,children:[(0,u.jsx)("br",{}),(0,u.jsxs)(l.wv,{className:"mb-3",children:[(0,u.jsxs)(l.AN,{id:"basic-addon1",children:["Lot Size : ",U[8]," x"]}),(0,u.jsx)(l.Ip,{value:f,onChange:e=>k(e.target.value),placeholder:"Quantity","aria-label":"Quantity","aria-describedby":"basic-addon1"})]})]})}),(0,u.jsxs)(l.AX,{children:[(0,u.jsx)(l.oV,{sm:12,children:(0,u.jsxs)(l.AN,{id:"basic-addon1",children:["Quantity x Lot Size : ",U[8]*f," "]})}),(0,u.jsxs)(l.oV,{sm:12,children:[(0,u.jsxs)(l.AN,{id:"basic-addon1",children:["Bid Price : ",I," "]}),(0,u.jsxs)(l.AN,{id:"basic-addon1",children:["Ask Price : ",O," "]})]})]}),"O"==U[9][0]&&(0,u.jsxs)("div",{className:"d-grid gap-2",children:[(0,u.jsx)("br",{}),(0,u.jsx)(l.uE,{color:"success",onClick:e=>Z(),children:"Place Order"})]}),"O"!==U[9][0]&&(0,u.jsxs)(l.AX,{children:[(0,u.jsx)(l.oV,{sm:6,children:(0,u.jsx)("div",{className:"d-grid gap-2",children:(0,u.jsx)(l.uE,{color:"success",onClick:e=>Z(),children:"Buy"})})}),(0,u.jsx)(l.oV,{sm:6,children:(0,u.jsx)("div",{className:"d-grid gap-2",children:(0,u.jsx)(l.uE,{color:"danger",onClick:e=>(async()=>{W(!0),Z()})(),children:"Sell"})})})]})]})]})]})}},85172:(e,t,s)=>{function a(e){const t=e.map((e=>e.bp)),s=e.map((e=>e.ap));return[Math.max(...t),Math.min(...s)]}function o(e){const t=e.map((e=>e.ap));return Math.max(...t)}s.d(t,{U9:()=>a,Z1:()=>o,a:()=>r});const r="eyJ0eXAiOiJKV1QiLCJrZXlfaWQiOiJza192MS4wIiwiYWxnIjoiSFMyNTYifQ.eyJzdWIiOiI2MkFIQVAiLCJqdGkiOiI2NWQ4MmJjNjI3ZWFkOTMzYjUzODM5YWYiLCJpc011bHRpQ2xpZW50IjpmYWxzZSwiaXNBY3RpdmUiOnRydWUsInNjb3BlIjpbImludGVyYWN0aXZlIiwiaGlzdG9yaWNhbCJdLCJpYXQiOjE3MDg2NjU3OTgsImlzcyI6InVkYXBpLWdhdGV3YXktc2VydmljZSIsImV4cCI6MTcwODcyNTYwMH0.aOzgAAo2X30P-edOaP3rjOVpzQ8KXW0s_8e_HRSwoI0"},92332:(e,t,s)=>{e.exports=s.p+"static/media/marketDataFeed.79b53914dafd92460c0d.proto"}}]);
//# sourceMappingURL=7840.6fae6003.chunk.js.map