"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[988],{73424:(e,t,o)=>{o.r(t),o.d(t,{default:()=>x});var r=o(69060),n=o(51560),s=o(98372),a=o(85172),i=o(3084);const c=o.p+"static/media/marketDataFeed.79b53914dafd92460c0d.proto";var l=o(63528),d=o(82496);const h=o(93424);let p=null;const x=()=>{const[e,t]=(0,r.useState)(!1),[o,x]=(0,r.useState)(!0),[m,u]=(0,r.useState)([]),[j,y]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),[k,z]=(0,r.useState)("open"),[_,N]=(0,r.useState)([]),v=(0,n.i6)();(0,r.useEffect)((()=>{o&&S(k),j.length>0&&((async()=>{p=await h.load(c),console.log("Protobuf part initialization complete")})(),w(a.a,j))}),[k,j,o]);const w=async(e,o)=>{console.log(o);try{const r=await(async e=>{let t={"Content-type":"application/json",Authorization:"Bearer "+e};const o=await fetch("https://api-v2.upstox.com/feed/market-data-feed/authorize",{method:"GET",headers:t});if(!o.ok)throw new Error("Network response was not ok");return(await o.json()).data.authorizedRedirectUri})(e),n=new WebSocket(r);return n.onopen=()=>{t(!0),console.log("Connected");const e={guid:"someguid",method:"sub",data:{mode:"full",instrumentKeys:o}};n.send(l.Sn.from(JSON.stringify(e)))},n.onclose=()=>{t(!1),console.log("Disconnected")},n.onmessage=async e=>{const t=await(async e=>"arrayBuffer"in e?await e.arrayBuffer():new Promise(((t,o)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=()=>o(),r.readAsArrayBuffer(e)})))(e.data);let o=(e=>p?p.lookupType("com.upstox.marketdatafeeder.rpc.proto.FeedResponse").decode(e):(console.warn("Protobuf part not initialized yet!"),null))(l.Sn.from(t));u(o.feeds),console.log(m)},n.onerror=e=>{t(!1),console.log("WebSocket error:",e)},()=>n.close()}catch(r){console.error("WebSocket connection error:",r)}},S=async e=>{const t=localStorage.getItem("userData");let o=JSON.parse(t);o=JSON.parse(o),console.log(o);let r=o.data.token;console.log(r);const n=o.data.user_id;z(e),x(!1);try{const t={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},o=await s.c.get("http://139.59.39.167/api/v1/order/filter/user/".concat(n,"/type/").concat(e),{headers:t});if(console.log("manig"),console.log(o.data),g(o.data.data),"open"==e){const e=o.data.map((e=>e.symbol));console.log(e),y(e)}console.log(o.data)}catch(a){console.error("Error fetching data:",a)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.AX,{children:(0,d.jsx)(i.oV,{sm:3,children:(0,d.jsxs)(i.Wc,{value:k,onChange:e=>S(e.target.value),children:[(0,d.jsx)("option",{value:"open",children:"Open"}),(0,d.jsx)("option",{value:"close",children:"Closed"}),(0,d.jsx)("option",{value:"all",children:"All"})]})})}),(0,d.jsx)(i.AX,{children:(0,d.jsx)(i.oV,{xs:!0,children:(0,d.jsxs)(i.u0,{className:"mb-4",children:[(0,d.jsx)(i.Q_,{children:"Portfolio"}),(0,d.jsx)(i.Yj,{children:(0,d.jsxs)(i.k7,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,striped:!0,children:[(0,d.jsx)(i.Iy,{color:"light",children:(0,d.jsxs)(i.uH,{children:[(0,d.jsx)(i.Qr,{children:"Trading Symbol"}),(0,d.jsx)(i.Qr,{className:"text-center",children:"Lot Size"}),(0,d.jsx)(i.Qr,{children:"Quantity"}),(0,d.jsx)(i.Qr,{children:"Expiry"}),(0,d.jsx)(i.Qr,{className:"text-center",children:"Entry Price"}),"all"!=k&&(0,d.jsx)(i.Qr,{className:"text-center",children:"P & L"}),(0,d.jsx)(i.Qr,{className:"text-center",children:"Exit Price"}),(0,d.jsx)(i.Qr,{className:"text-center",children:"Entry Time"}),(0,d.jsx)(i.Qr,{className:"text-center",children:"Exit Time"}),"open"===k&&(0,d.jsx)(i.Qr,{className:"text-center",children:"Close Order"})]})}),(0,d.jsx)(i.g7,{children:null===f||void 0===f?void 0:f.map(((e,t)=>(0,d.jsxs)(i.uH,{"v-for":"item in tableItems",children:[(0,d.jsx)(i.kz,{className:"text-center",children:(0,d.jsx)("div",{children:e.trading_symbol})}),(0,d.jsx)(i.kz,{className:"text-center",children:(0,d.jsx)("div",{children:e.lot_size})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.quantity})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.expiry_date})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.open_price})}),"open"===k&&(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:m[e.symbol]?((0,a.Z1)(m[e.symbol].ff.marketFF.marketLevel.bidAskQuote)*e.lot_size*e.quantity-e.open_price*e.lot_size*e.quantity).toFixed(3):0})}),"close"===k&&(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:(e.close_price*e.lot_size*e.quantity-e.open_price*e.lot_size*e.quantity).toFixed(3)})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.close_price})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.open_time})}),(0,d.jsx)(i.kz,{children:(0,d.jsx)("div",{children:e.close_time})}),"open"===k&&(0,d.jsx)(i.kz,{className:"text-center",children:(0,d.jsx)(i.uE,{color:"dark",onClick:t=>{(async e=>{const t=JSON.stringify(e);console.log("main"),console.log(t),await localStorage.setItem("placeOrderData",t),v("/close-order")})(e)},children:"Close Order"})})]},t)))})]})})]})})})]})}},85172:(e,t,o)=>{function r(e){const t=e.map((e=>e.bp)),o=e.map((e=>e.ap));return[Math.max(...t),Math.min(...o)]}function n(e){const t=e.map((e=>e.ap));return Math.max(...t)}o.d(t,{U9:()=>r,Z1:()=>n,a:()=>s});const s="eyJ0eXAiOiJKV1QiLCJrZXlfaWQiOiJza192MS4wIiwiYWxnIjoiSFMyNTYifQ.eyJzdWIiOiI2MkFIQVAiLCJqdGkiOiI2NWQ4MmJjNjI3ZWFkOTMzYjUzODM5YWYiLCJpc011bHRpQ2xpZW50IjpmYWxzZSwiaXNBY3RpdmUiOnRydWUsInNjb3BlIjpbImludGVyYWN0aXZlIiwiaGlzdG9yaWNhbCJdLCJpYXQiOjE3MDg2NjU3OTgsImlzcyI6InVkYXBpLWdhdGV3YXktc2VydmljZSIsImV4cCI6MTcwODcyNTYwMH0.aOzgAAo2X30P-edOaP3rjOVpzQ8KXW0s_8e_HRSwoI0"}}]);
//# sourceMappingURL=988.b7dbd0a7.chunk.js.map